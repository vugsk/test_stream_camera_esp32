# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

## üìê –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

ESP32-CAM Video Stream Client –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
test_stream_camera_esp32/
‚îú‚îÄ‚îÄ include/                    # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.h               # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ camera.h               # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–µ—Ä–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ wifi_client.h          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ wifi_settings.h        # –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ WiFi –≤ NVS
‚îÇ   ‚îú‚îÄ‚îÄ bluetooth_config.h     # Bluetooth –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ stream_client.h        # HTTP —Å—Ç—Ä–∏–º–∏–Ω–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ server_settings.h      # –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ src/                       # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, state machine
‚îÇ   ‚îú‚îÄ‚îÄ camera.cpp            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞—Ö–≤–∞—Ç –∫–∞–¥—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ wifi_client.cpp       # WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ wifi_settings.cpp     # NVS –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è WiFi
‚îÇ   ‚îú‚îÄ‚îÄ bluetooth_config.cpp  # –ü—Ä–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ BT
‚îÇ   ‚îú‚îÄ‚îÄ stream_client.cpp     # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ server_settings.cpp   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ docs/                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ platformio.ini            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PlatformIO
```

## üîÑ –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (State Machine)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  STATE_INIT ‚îÇ ‚îÄ‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ NVS –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–π–¥–µ–Ω—ã ‚îÄ‚îÄ‚Üí STATE_WIFI_CONNECTING
       ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚îÄ‚îÄ‚Üí STATE_BLUETOOTH_WAITING
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è:

#### 1. **STATE_INIT**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è server_host –≤ NVS –∏–ª–∏ config.h
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö WiFi credentials
- –ü–µ—Ä–µ—Ö–æ–¥ –≤ STATE_WIFI_CONNECTING –∏–ª–∏ STATE_BLUETOOTH_WAITING

#### 2. **STATE_WIFI_CONNECTING**
- –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ WiFi
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Üí STATE_WIFI_CONNECTED
- –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ ‚Üí STATE_WIFI_RETRY

#### 3. **STATE_WIFI_RETRY**
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–¥–æ 3 —Ä–∞–∑)
- –ó–∞–¥–µ—Ä–∂–∫–∞ 5 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
- –ü–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ ‚Üí STATE_BLUETOOTH_WAITING

#### 4. **STATE_BLUETOOTH_WAITING**
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è Bluetooth —Å –∏–º–µ–Ω–µ–º "ESP32-CAM-Config"
- –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ credentials ‚Üí STATE_WIFI_CONNECTING
- Timeout 5 –º–∏–Ω—É—Ç ‚Üí STATE_WIFI_RETRY

#### 5. **STATE_WIFI_CONNECTED**
- **–ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫ –∫–∞–º–µ—Ä–µ
- –ó–∞–ø—É—Å–∫ –≤–∏–¥–µ–æ—Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ (5 –ø–æ–ø—ã—Ç–æ–∫) ‚Üí STATE_BLUETOOTH_WAITING
- –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ WiFi ‚Üí STATE_WIFI_RETRY

## üß© –ú–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã

### 1. Camera Module (`camera.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç—å—é –∫–∞–º–µ—Ä—ã

**–§—É–Ω–∫—Ü–∏–∏**:
- `initCamera()` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OV2640 —Å–µ–Ω—Å–æ—Ä–∞
- `captureFrame()` ‚Äî –∑–∞—Ö–≤–∞—Ç JPEG –∫–∞–¥—Ä–∞
- `releaseFrame()` ‚Äî –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –∫–∞–º–µ—Ä—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –î–≤–æ–π–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è (fb_count=2)
- PSRAM –¥–ª—è HD –∫–∞–¥—Ä–æ–≤
- CAMERA_GRAB_LATEST ‚Äî –ø—Ä–æ–ø—É—Å–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–∞–¥—Ä–æ–≤

### 2. WiFi Client Module (`wifi_client.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

**–§—É–Ω–∫—Ü–∏–∏**:
- `initWiFi()` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WiFi —Å–µ—Ç–∏
- `isWiFiConnected()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- `checkWiFiConnection()` ‚Äî –∞–≤—Ç–æ–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- `disconnectWiFi()` ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–∞–¥–∏–æ

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- –û—Ç–∫–ª—é—á–µ–Ω WiFi sleep —Ä–µ–∂–∏–º
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ (19.5dBm)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ

### 3. WiFi Settings Module (`wifi_settings.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–∞–º—è—Ç–∏

**–§—É–Ω–∫—Ü–∏–∏**:
- `saveWiFiCredentials()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ SSID –∏ –ø–∞—Ä–æ–ª—è
- `loadWiFiCredentials()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ NVS
- `saveServerHost()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
- `getCurrentServerHost()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Å fallback

**–•—Ä–∞–Ω–∏–ª–∏—â–µ**: NVS (Non-Volatile Storage) –≤ —Ä–∞–∑–¥–µ–ª–µ "wifi"

### 4. Bluetooth Config Module (`bluetooth_config.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Bluetooth

**–§—É–Ω–∫—Ü–∏–∏**:
- `startBluetoothConfig()` ‚Äî –∞–∫—Ç–∏–≤–∞—Ü–∏—è BT
- `handleBluetoothConfig()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `hasNewWiFiCredentials()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö**:
```json
// JSON —Ñ–æ—Ä–º–∞—Ç
{"ssid":"WiFi","password":"pass","server_host":"192.168.1.100"}

// –ü—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç (CSV)
WiFi,pass,192.168.1.100
```

### 5. Stream Client Module (`stream_client.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–§—É–Ω–∫—Ü–∏–∏**:
- `startStreaming()` ‚Äî –∑–∞–ø—É—Å–∫ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- `sendFrame()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –∫–∞–¥—Ä–∞
- `setStreamFPS()` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ FPS

**HTTP –ø—Ä–æ—Ç–æ–∫–æ–ª**:
```http
POST /stream HTTP/1.1
Host: 192.168.1.100:8081
Content-Type: image/jpeg
Content-Length: 45678
Connection: keep-alive
X-Frame: 1234

[JPEG data]
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- Keep-alive —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ß–∞–Ω–∫–∏ –ø–æ 16KB –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–¥–∞—á–∏
- Async –æ—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤
- –¢–∞–π–º–∞—É—Ç—ã 500ms

### 6. Server Settings Module (`server_settings.cpp/h`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å —Å–µ—Ä–≤–µ—Ä–∞

**–§—É–Ω–∫—Ü–∏–∏**:
- `fetchInitialSettingsFromServer()` ‚Äî –ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- `handleServerSettings()` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å
- `applyCameraSettings()` ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `sendStatusToServer()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏

**HTTP API**:
```
GET  /api/camera  ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–º–µ—Ä—ã
POST /api/status  ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –í–∏–¥–µ–æ–ø–æ—Ç–æ–∫ (Camera ‚Üí Server)

```
1. captureFrame() 
   ‚Üì
2. JPEG –±—É—Ñ–µ—Ä (PSRAM)
   ‚Üì
3. sendFrameData()
   ‚Üì
4. TCP chunks (16KB)
   ‚Üì
5. WiFi ‚Üí Internet
   ‚Üì
6. Server HTTP endpoint /stream
```

### –£–ø—Ä–∞–≤–ª—è—é—â–∏–π –ø–æ—Ç–æ–∫ (Server ‚Üí Camera)

```
1. Server /api/camera endpoint
   ‚Üì
2. HTTP GET –∑–∞–ø—Ä–æ—Å (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)
   ‚Üì
3. JSON –æ—Ç–≤–µ—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
   ‚Üì
4. processSettings()
   ‚Üì
5. applyCameraSettings()
   ‚Üì
6. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ OV2640 —Å–µ–Ω—Å–æ—Ä—É
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Bluetooth

```
Mobile App (Bluetooth Serial)
   ‚Üì
ESP32 BluetoothSerial
   ‚Üì
handleBluetoothConfig()
   ‚Üì
JSON/CSV –ø–∞—Ä—Å–∏–Ω–≥
   ‚Üì
saveWiFiCredentials()
   ‚Üì
NVS Storage
   ‚Üì
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```

## üß† –ü–∞–º—è—Ç—å –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### PSRAM
- –ë—É—Ñ–µ—Ä—ã –∫–∞–º–µ—Ä—ã (–¥–æ 150KB –Ω–∞ HD –∫–∞–¥—Ä)
- –î–≤–æ–π–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞

### NVS (Non-Volatile Storage)
```
–†–∞–∑–¥–µ–ª "wifi":
- ssid           (String)
- password       (String)
- server_host    (String)

–†–∞–∑–¥–µ–ª "camera":
- frameSize      (int)
- quality        (int)
- brightness     (int)
- contrast       (int)
- saturation     (int)
- fps            (int)
- vflip          (bool)
- hmirror        (bool)
- streaming      (bool)

–†–∞–∑–¥–µ–ª "bluetooth":
- name           (String)
- enabled        (bool)
```

## üîí –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### WiFi –æ—à–∏–±–∫–∏
- –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- –ü–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ ‚Üí Bluetooth —Ä–µ–∂–∏–º

### Server –æ—à–∏–±–∫–∏
- –°—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ (–º–∞–∫—Å. 5)
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ ‚Üí Bluetooth —Ä–µ–∂–∏–º –¥–ª—è –ø–µ—Ä–µ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç WiFi/Bluetooth
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `connectionState != STATE_BLUETOOTH_WAITING`
- –ü–æ–ª–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ WiFi (`WiFi.mode(WIFI_OFF)`) –ø–µ—Ä–µ–¥ BT
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ Bluetooth –ø–µ—Ä–µ–¥ WiFi

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ CPU
- –ß–∞—Å—Ç–æ—Ç–∞: 240 MHz
- –û—Ç–∫–ª—é—á–µ–Ω WiFi Power Save
- CAMERA_GRAB_LATEST (–ø—Ä–æ–ø—É—Å–∫ —Å—Ç–∞—Ä—ã—Ö –∫–∞–¥—Ä–æ–≤)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–µ—Ç–∏
- TCP NoDelay
- Keep-Alive —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ë–æ–ª—å—à–∏–µ —á–∞–Ω–∫–∏ (16KB)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã (500ms)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏
- PSRAM –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞–¥—Ä–æ–≤
- –î–≤–æ–π–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è
- –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏

```
main.cpp
  ‚îú‚îÄ‚Üí camera.cpp (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)
  ‚îú‚îÄ‚Üí wifi_client.cpp (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
  ‚îú‚îÄ‚Üí wifi_settings.cpp (–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
  ‚îú‚îÄ‚Üí bluetooth_config.cpp (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
  ‚îú‚îÄ‚Üí stream_client.cpp (—Å—Ç—Ä–∏–º–∏–Ω–≥)
  ‚îî‚îÄ‚Üí server_settings.cpp (—É–¥–∞–ª–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

stream_client.cpp
  ‚îú‚îÄ‚Üí camera.cpp (–∑–∞—Ö–≤–∞—Ç –∫–∞–¥—Ä–æ–≤)
  ‚îú‚îÄ‚Üí wifi_client.cpp (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
  ‚îî‚îÄ‚Üí wifi_settings.cpp (–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞)

server_settings.cpp
  ‚îú‚îÄ‚Üí camera.cpp (–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫ —Å–µ–Ω—Å–æ—Ä—É)
  ‚îú‚îÄ‚Üí stream_client.cpp (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ FPS, —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø)
  ‚îî‚îÄ‚Üí wifi_settings.cpp (–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞)
```

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** ‚Äî –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –Ω–µ–∑–∞–≤–∏—Å–∏–º
2. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** ‚Äî –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ
4. **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
5. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥ –∏ API
